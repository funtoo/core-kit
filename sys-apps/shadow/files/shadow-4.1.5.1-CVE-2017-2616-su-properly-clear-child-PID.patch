diff -Nuar shadow-4.1.5.1/src/su.c shadow-4.1.5.1-fixed/src/su.c
--- shadow-4.1.5.1/src/su.c	2012-05-25 11:51:55.000000000 +0000
+++ shadow-4.1.5.1-fixed/src/su.c	2017-06-08 16:34:17.971144574 +0000
@@ -362,11 +362,13 @@
 				/* wake child when resumed */
 				kill (pid, SIGCONT);
 				stop = false;
+			} else {
+				pid_child = 0;
 			}
 		} while (!stop);
 	}
 
-	if (0 != caught) {
+	if (0 != caught && 0 != pid_child) {
 		(void) fputs ("\n", stderr);
 		(void) fputs (_("Session terminated, terminating shell..."),
 		              stderr);
@@ -385,9 +387,23 @@
 
 	if (0 != caught) {
 		(void) signal (SIGALRM, kill_child);
+		(void) signal (SIGCHLD, catch_signals);
 		(void) alarm (2);
 
 		(void) wait (&status);
+		sigemptyset (&ourset);
+		if ((sigaddset (&ourset, SIGALRM) != 0)
+			|| (sigprocmask (SIG_BLOCK, &ourset, NULL) != 0)) {
+				fprintf (stderr, _("%s: signal masking malfunction\n"), Prog);
+				kill_child (0);
+		} else {
+				while (0 == waitpid (pid_child, &status, WNOHANG)) {
+						sigsuspend (&ourset);
+				}
+				pid_child = 0;
+				(void) sigprocmask (SIG_UNBLOCK, &ourset, NULL);
+		}
+
 		(void) fputs (_(" ...terminated.\n"), stderr);
 	}
 
