diff -Nuar rsync-3.1.2/xattrs.c rsync-3.1.2-fixed/xattrs.c
--- rsync-3.1.2/xattrs.c	2015-08-08 19:47:03.000000000 +0000
+++ rsync-3.1.2-fixed/xattrs.c	2017-12-19 17:03:58.911931796 +0000
@@ -696,6 +696,10 @@
 			out_of_memory("receive_xattr");
 		name = ptr + dget_len + extra_len;
 		read_buf(f, name, name_len);
+		if (name_len < 1 || name[name_len-1] != '\0') {
+			rprintf(FERROR, "Invalid xattr name received (missing trailing \\0).\n");
+			exit_cleanup(RERR_FILEIO);
+		}
 		if (dget_len == datum_len)
 			read_buf(f, ptr, dget_len);
 		else {
